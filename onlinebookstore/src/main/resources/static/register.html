<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Register | Online Bookstore</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <link rel="icon" href="favicon.ico" />
</head>
<body class="bg-light">
  <div class="container mt-5">
    <h2 class="mb-4 text-center">üìù Register</h2>
    <div class="card p-4 shadow-sm mx-auto" style="max-width: 400px;">
      <form onsubmit="register(event)">
        <div class="mb-3">
          <label>Name</label>
          <input type="text" id="name" class="form-control" required/>
        </div>
        <div class="mb-3">
          <label>Email</label>
          <input type="email" id="email" class="form-control" required/>
        </div>
        <div class="mb-3">
          <label>Password</label>
          <input type="password" id="password" class="form-control" required/>
        </div>
        <div class="mb-3">
          <label>Confirm Password</label>
          <input type="password" id="confirmPassword" class="form-control" required/>
        </div>
        <button class="btn btn-success w-100">Register</button>
      </form>
      <p class="mt-3 text-center">Already have an account? <a href="login.html">Login here</a></p>
    </div>
  </div>

  <script>
   function register(e) {
  e.preventDefault();
  const name = document.getElementById("name").value;
  const email = document.getElementById("email").value;
  const password = document.getElementById("password").value;
  const confirmPassword = document.getElementById("confirmPassword").value;

  if (name.length < 3) {
    alert("Name should be at least 3 characters long");
    return;
  }

  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  if (!emailRegex.test(email)) {
    alert("Please enter a valid email");
    return;
  }

  if (password.length < 6) {
    alert("Password must be at least 6 characters");
    return;
  }

  if (password !== confirmPassword) {
    alert("Passwords do not match");
    return;
  }

  fetch("https://onlinebookstore-production-0f47.up.railway.app/api/auth/register", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ name, email, password })
  })
  .then(res => {
    if (!res.ok) {
      return res.text().then(text => { throw new Error(text); });
    }
    return res.text();
  })
  .then(msg => {
    showToast(msg);  // will show "Registered successfully!"
    setTimeout(() => {
      window.location.href = "login.html";
    }, 3000);
  })
  .catch(err => alert(err.message));  // will show "Email already exists"
}

  </script>
    <div class="toast-container position-fixed top-0 end-0 p-3" style="z-index: 1100;">
  <div id="liveToast" class="toast text-bg-success border-0" role="alert" data-bs-delay="2500">
    <div class="toast-body" id="toastMsg"></div>
  </div>
</div>
<script>
  function showToast(message) {
    const toastMsg = document.getElementById("toastMsg");
    toastMsg.innerText = message;
    const toast = new bootstrap.Toast(document.getElementById("liveToast"));
    toast.show();
  }
</script>

</body>
</html>
